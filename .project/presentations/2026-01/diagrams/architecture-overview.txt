# Architecture Diagrams

These diagrams are embedded in the slides as ASCII art for portability.
If you need higher-quality graphics, recreate these in a tool like:
- Excalidraw (https://excalidraw.com)
- Mermaid (https://mermaid.live)
- Draw.io (https://draw.io)

---

## High-Level Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                  VS Code Extension                           │
│         (Workflow UI, Chat, Status Panels)                   │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      Aura API                                │
│                 (REST Endpoints)                             │
└─────────────────────────────────────────────────────────────┘
                              │
         ┌────────────────────┼────────────────────┐
         ▼                    ▼                    ▼
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│ Aura.Module.    │  │ Aura.Module.    │  │ Aura.Module.    │
│   Developer     │  │   Research      │  │   Personal      │
│                 │  │   (Future)      │  │   (Future)      │
└─────────────────┘  └─────────────────┘  └─────────────────┘
         │                    │                    │
         └────────────────────┼────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                   Aura.Foundation                            │
│    Agents │ LLM │ RAG │ Tools │ Database │ Modules          │
└─────────────────────────────────────────────────────────────┘
                              │
         ┌────────────────────┼────────────────────┐
         ▼                    ▼                    ▼
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│     Ollama      │  │   PostgreSQL    │  │  File System    │
│ (Local LLM)     │  │  + pgvector     │  │  (Your Code)    │
└─────────────────┘  └─────────────────┘  └─────────────────┘
```

---

## RAG Pipeline

```
┌─────────────────────────────────────────────────────────────┐
│                      RAG Pipeline                            │
│                                                              │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐               │
│  │  Ingest  │───▶│  Embed   │───▶│  Store   │               │
│  │  Files   │    │ (Ollama) │    │(pgvector)│               │
│  └──────────┘    └──────────┘    └──────────┘               │
│                                                              │
│  ┌──────────┐    ┌──────────┐    ┌──────────┐               │
│  │  Query   │───▶│  Search  │───▶│ Retrieve │               │
│  │          │    │ (vector) │    │ Context  │               │
│  └──────────┘    └──────────┘    └──────────┘               │
│                                                              │
│  Embedding Model: nomic-embed-text (137M params)             │
│  Index: HNSW for approximate nearest neighbor                │
└─────────────────────────────────────────────────────────────┘
```

---

## ReAct Loop

```
┌─────────────────────────────────────────────────────────────┐
│                    ReAct Execution Loop                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. Agent receives task + available tools                   │
│  2. Agent THINKS: "What do I need to do?"                   │
│  3. Agent ACTS: Outputs tool call (e.g., read_file)         │
│  4. System executes tool, returns OBSERVATION               │
│  5. Loop continues until agent says "DONE"                  │
│  6. Final response returned to caller                       │
│                                                              │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐                 │
│  │  THINK  │───►│   ACT   │───►│ OBSERVE │───┐             │
│  └─────────┘    └─────────┘    └─────────┘   │             │
│       ▲                                       │             │
│       └───────────────────────────────────────┘             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## Developer Workflow

```
┌─────────────────────────────────────────────────────────────────┐
│                    LOCAL-ONLY WORKFLOW                           │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  1. CREATE WORKFLOW                                              │
│     └─> User describes task                                      │
│     └─> Git worktree created for isolation                       │
│                                                                  │
│  2. ANALYZE (Enrich with RAG)                                    │
│     └─> Agent finds related code, patterns, docs                 │
│     └─> Structured requirements generated                        │
│                                                                  │
│  3. PLAN (Generate Steps)                                        │
│     └─> Business analyst agent creates execution plan            │
│     └─> Each step: capability + description                      │
│                                                                  │
│  4. EXECUTE (Human-in-the-Loop)                                  │
│     └─> One step at a time                                       │
│     └─> User: approve / reject / skip / chat / reassign         │
│                                                                  │
│  5. COMPLETE                                                     │
│     └─> Commit, push, create PR                                  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Composable Modules

```
┌─────────────────────────────────────────────────────────────┐
│                    Vertical Modules                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │   Developer  │  │   Research   │  │   Personal   │  ...  │
│  │    Module    │  │    Module    │  │    Module    │       │
│  │  (optional)  │  │  (optional)  │  │  (optional)  │       │
│  └──────────────┘  └──────────────┘  └──────────────┘       │
│            │              │               │                  │
│            └──────────────┼───────────────┘                  │
│                           │                                  │
│                           ▼                                  │
├─────────────────────────────────────────────────────────────┤
│                Aura.Foundation (always loaded)               │
│   Agents │ LLM │ RAG │ Database │ Tools │ Modules           │
└─────────────────────────────────────────────────────────────┘
```

---

## Agent Execution Flow

```
┌──────────────────────────────────────────────────────────────┐
│                   Agent Execution                             │
│                                                              │
│  ┌────────────────┐                                          │
│  │ Agent Markdown │  "Who you are" (system prompt)           │
│  └───────┬────────┘                                          │
│          │                                                   │
│          ▼                                                   │
│  ┌────────────────┐                                          │
│  │  RAG Context   │  Auto-injected from indexed code         │
│  └───────┬────────┘                                          │
│          │                                                   │
│          ▼                                                   │
│  ┌────────────────┐                                          │
│  │ Prompt Template│  "What to do" (Handlebars + YAML)        │
│  └───────┬────────┘                                          │
│          │                                                   │
│          ▼                                                   │
│  ┌────────────────┐                                          │
│  │  LLM Provider  │  Ollama / Azure OpenAI / OpenAI          │
│  └────────────────┘                                          │
└──────────────────────────────────────────────────────────────┘
```

---

## Code Graph Schema

```
Nodes:
┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ Solution │  │ Project  │  │  Type    │  │  Member  │
└──────────┘  └──────────┘  └──────────┘  └──────────┘

Edges:
─── contains ──▶
─── inherits ──▶
─── implements ──▶
─── calls ──▶
─── uses ──▶
```

---

## Mermaid Versions

If your tooling supports Mermaid, here are equivalent diagrams:

### Architecture

```mermaid
graph TB
    subgraph Client
        Extension[VS Code Extension]
    end
    
    subgraph API
        AuraApi[Aura API]
    end
    
    subgraph Modules
        Dev[Developer Module]
        Research[Research Module]
        Personal[Personal Module]
    end
    
    subgraph Foundation
        Agents
        LLM
        RAG
        Tools
        Database
    end
    
    subgraph Infrastructure
        Ollama
        PostgreSQL
        FileSystem[File System]
    end
    
    Extension --> AuraApi
    AuraApi --> Dev
    AuraApi --> Research
    AuraApi --> Personal
    Dev --> Foundation
    Research --> Foundation
    Personal --> Foundation
    Foundation --> Ollama
    Foundation --> PostgreSQL
    Foundation --> FileSystem
```

### RAG Pipeline

```mermaid
flowchart LR
    Ingest[Ingest Files] --> Embed[Embed with Ollama]
    Embed --> Store[Store in pgvector]
    Query[Query] --> Search[Vector Search]
    Search --> Retrieve[Retrieve Context]
```

### ReAct Loop

```mermaid
flowchart LR
    Think[THINK] --> Act[ACT]
    Act --> Observe[OBSERVE]
    Observe --> Think
    Observe --> Done[DONE]
```
